<div class="container office listings">
  <div class="container-fluid">
   	<div class="row">
      <div class="col-lg-6">
        <div class="row">
          <div class="col-lg-12" style="padding-left:0px;">
            <div id="map-canvas" style="width:100%;height:700px;">
            </div>
          </div>
        </div>
      </div>	

   		<div class="col-lg-6" style="position:fixed;overflow-y:scroll;right:0;top:124px;bottom:0;">
        <div class="row">
     			<div class="col-lg-12">
            <%= form_tag offices_path, :method => :get, :style => 'padding:0px; border:none;' do %>
              <div class="field">
                <%= text_field_tag :min_price, params[:min_price], :placeholder => 'Prix (min)', :style => 'width:30%;' %>
                <%= text_field_tag :max_price, params[:max_price], :placeholder => 'Prix (max)', :style => 'width:30%;' %>
                <br>
                <%= text_field_tag :min_price, params[:min_price], :placeholder => 'Surface (min)', :style => 'width:30%; margin-top:10px;' %>
                <%= text_field_tag :max_price, params[:max_price], :placeholder => 'Surface (max)', :style => 'width:30%;' %>
                <br>
                <%= submit_tag "Recherche",  :class =>"btn btn-default btn-primary", :style => 'width:20%;background-color:#e67e22; border:none;margin-top:10px;' %>
              </div>
            <% end %>
            <%= will_paginate @offices, renderer: BootstrapPagination::Rails %>
  					<ul>
  						<% @offices.each do |o| %>
  			        <li>
                  <%= link_to office_path(o) do %>
  			        	<div class="row" id="office_list">
  			            <div class="col-lg-4">
  			            	<%= image_tag o.image_url.to_s, :id => "office_listing_image" %>
  			            </div>
  			            <div class="col-lg-6">
  			            	<h2 style="margin-top:0px;margin-bottom:0px;font-size:20px;"><%= o.title_of_offer%></h2><br>
  			            	<%= o.full_street_address %><br>
  			            	<%= o.surface_min.to_i %> a <%= o.surface_max.to_i %> mÂ²<br>
  			            	<%= o.price_min.to_i %> jusque <%= o.price_max.to_i %> <i class="fa fa-euro"></i>
  									</div>
  								</div>
                  <% end %>
  							</li>
  						<% end %>
  					</ul>
            <%= will_paginate @offices, renderer: BootstrapPagination::Rails %>
  				</div>
        </div>
   		</div>
		</div>
	</div>
</div>
<script>
  $(function() {
    
    var mapOptions = {
      zoom: 14,
      disableDefaultUI: false,
      scrollwheel: false,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
       
    var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);

    var bounds  = new google.maps.LatLngBounds();
    $.getJSON('/offices.json', { page: <%= @page || 1 %>, search: '<%= @city %>' }, function(data) {
      $.each(data, function(index, office) {
        var latlng = new google.maps.LatLng(office.latitude, office.longitude);
        var markerLatLng = new google.maps.LatLng(office.latitude, office.longitude);
        var image = '/assets/icons/map-icon.png';

        bounds.extend(latlng);
        var marker = new google.maps.Marker({
            position: markerLatLng,
            icon: image,
            map: map,
            title: office.full_street_address
        });
      });
      map.fitBounds(bounds);
    });
  });
</script>
