<div class="container office listings">
  <div class="container-fluid">
   	<div class="row">
      <div class="col-lg-6">
        <div class="row">
          <div class="col-lg-12" style="padding-left:0px;">
            <div id="map-canvas" style="width:690px;height:670px;position:fixed !important;">
            </div>
          </div>
        </div>
      </div>	
   		<div class="col-lg-6" style="position:fixed;overflow-y:scroll;right:0;top:124px;bottom:0;">
        <div class="row">
     			<div class="col-lg-12">
            <%= will_paginate @offices, renderer: BootstrapPagination::Rails %>
  					<ul>
  						<% @offices.each do |o| %>
  			        <li>
                  <%= link_to office_path(o) do %>
  			        	<div class="row" id="office_list">
  			            <div class="col-lg-4">
  			            	<%= image_tag o.image_url.to_s, :id => "office_listing_image" %>
  			            </div>
  			            <div class="col-lg-6">
  			            	<h2 style="margin-top:0px;margin-bottom:0px;font-size:20px;"><%= o.title_of_offer%></h2><br>
  			            	<%= o.full_street_address %><br>
  			            	<%= o.surface_min.to_i %> a <%= o.surface_max.to_i %> mÂ²<br>
  			            	<%= o.price_min.to_i %> jusque <%= o.price_max.to_i %> <i class="fa fa-euro"></i>
  									</div>
  								</div>
                  <% end %>
  							</li>
  						<% end %>
  					</ul>
            <%= will_paginate @offices, renderer: BootstrapPagination::Rails %>
  				</div>
        </div>
   		</div>
		</div>
	</div>
</div>
<script>

  $(function() {
    
    var mapOptions = {
          center: new google.maps.LatLng(48.8567, 2.3508),
          zoom: 14,
          disableDefaultUI: true,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        
        var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);

      $.getJSON('/offices.json', function(data) {
        $.each(data, function(index, value) {
        
        var markerLatLng = new google.maps.LatLng(data[index].latitude, data[index].longitude);
        var image = '/assets/icons/map-icon.png';
          var marker = new google.maps.Marker({
              position: markerLatLng,
              icon: image,
            map: map,
              title: data[index].full_street_address
          });

          var contentString = '<h4>' + data[index].full_street_address.toString() + '</h4>';
          // console.log(data[index].full_street_address.toString())

          google.maps.event.addListener(marker, 'click', function() {
            infowindow.setContent(contentString);
            infowindow.open(map,marker);
          });
        });
      });
  });
</script>
